<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <record id="mrp.mrp_workcenter_tree_view" model="ir.ui.view">
        <field name="name">mrp.workcenter.tree</field>
        <field name="model">mrp.workcenter</field>
        <field name="arch" type="xml">
            <tree string="Work Center" multi_edit="1">
                <field name="sequence" widget="handle" />
                <field name="name" />
                <field name="code" optional="show" />
                <field
                    name="tag_ids"
                    widget="many2many_tags"
                    options="{'no_create': True, 'color_field': 'color'}"
                    optional="show"
                />
                <field name="mrp_workcenter_team_id" />
                <field name="user_id" widget="many2one_avatar_user" optional="show" />
                <field name="productive_time" optional="hide" />
                <field name="costs_hour" optional="show" string="Variable Cost Rate" />
                <field name="default_capacity" optional="show" string="Capacity" />
                <field name="time_efficiency" optional="show" />
                <field name="oee_target" optional="hide" />
                <field name="time_start" optional="show" />
                <field name="time_stop" optional="show" />
                <field
                    name="company_id"
                    groups="base.group_multi_company"
                    optional="hide"
                />
                <field name="active" invisible="1" />
            </tree>
        </field>
    </record>

    <record id="mrp_workcenter_view" model="ir.ui.view">
        <field name="name">mrp.workcenter.form</field>
        <field name="model">mrp.workcenter</field>
        <field name="inherit_id" ref="mrp.mrp_workcenter_view" />
            <field name="arch" type="xml">
                <div name="button_box" position="inside">
                    <button
                    class="oe_stat_button"
                    name="attachment_tree_view"
                    type="object"
                    icon="fa-files-o"
                >
                        <field string="Documents" name="doc_count" widget="statinfo" />
                    </button>
                </div>
                <field name="tag_ids" position="after">
                    <field name="mrp_workcenter_team_id" />
                    <field name="user_id" />
                </field>
                <field name="alternative_workcenter_ids" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <group name="costing" position="before">
                    <group string="Shop Floor Control">
                        <field name="start_without_stock" />
                    </group>
                </group>
                <field name="default_capacity" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="default_capacity" position="before">
                    <label
                    for="available_capacity"
                    string="Capacity/Overlapping Processing"
                />
                    <div class="o_row">
                        <field name="available_capacity" />
                        <field name="overlapping" />
                    </div>
                </field>
                <notebook>
                    <page
                    string="Capacity Load"
                    name="capacity_load"
                    attrs="{'invisible': [('create_uid', '=', False)]}"
                >
                        <group>
                            <field
                            name="capacity_chart"
                            widget="plotly_chart"
                            nolabel="1"
                        />
                            <field name="create_uid" invisible="1" />
                        </group>
                    </page>
                </notebook>
            </field>
    </record>

    <record id="mrp.view_mrp_workcenter_search" model="ir.ui.view">
        <field name="name">mrp.workcenter.product.costing.filter</field>
        <field name="model">mrp.workcenter</field>
        <field name="arch" type="xml">
            <search string="Search for mrp workcenter">
                <field
                    name="name"
                    string="Work Center"
                    filter_domain="['|', ('name', 'ilike', self), ('code', 'ilike', self)]"
                />
                <filter
                    name="archived"
                    string="Archived"
                    domain="[('active', '=', False)]"
                />
                <searchpanel>
                    <field
                        name="tag_ids"
                        select="multi"
                        icon="fa-tag"
                        enable_counters="1"
                    />
                    <field
                        name="mrp_workcenter_team_id"
                        select="multi"
                        enable_counters="1"
                    />
                </searchpanel>
            </search>
        </field>
    </record>

    <record id="mrp_workcenter_action" model="ir.actions.act_window">
        <field name="name">Work Centers</field>
        <field name="res_model">mrp.workcenter</field>
        <field name="view_mode">tree,form,kanban</field>
        <field name="search_view_id" ref="mrp.view_mrp_workcenter_search" />
    </record>

    <menuitem
        id="mrp.menu_mrp_bom"
        name="Master Data"
        parent="mrp.menu_mrp_root"
        sequence="20"
    />

    <menuitem
        id="mrp.menu_view_resource_search_mrp"
        action="mrp_workcenter_action"
        groups="mrp.group_mrp_routings"
        parent="mrp.menu_mrp_bom"
        sequence="90"
    />

    <!-- Tags -->
    <record model="ir.ui.view" id="mrp_workcenter_tags_tree_view">
        <field name="name">mrp.workcenter.tags.tree.view</field>
        <field name="model">mrp.workcenter.tag</field>
        <field name="arch" type="xml">
            <tree string="Tags" editable="top">
                <field name="name" />
                <field name="color" widget="color_picker" optional="show" />
            </tree>
        </field>
    </record>

    <record model="ir.ui.view" id="mrp_workcenter_tags_form_view">
        <field name="name">mrp.workcenter.tags.form.view</field>
        <field name="model">mrp.workcenter.tag</field>
        <field name="arch" type="xml">
            <form string="Tags">
                <sheet>
                    <group>
                        <field name="name" />
                        <field name="color" widget="color_picker" />
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record model="ir.ui.view" id="mrp_workcenter_tags_search_view">
        <field name="name">mrp.workcenter.tags.search.view</field>
        <field name="model">mrp.workcenter.tag</field>
        <field name="arch" type="xml">
            <search>
                <field name="name" />
            </search>
        </field>
    </record>

    <record id="mrp_workcenter_tags_action" model="ir.actions.act_window">
        <field name="name">Workcenter Tags</field>
        <field name="res_model">mrp.workcenter.tag</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
            No tags found. Let's create one!
            </p>
            <p>
                Use tags to categorize your mrp workcenters.
            </p>
        </field>
    </record>

    <menuitem
        action="mrp_workcenter_tags_action"
        id="menu_mrp_workcenter_tags"
        parent="mrp.menu_mrp_configuration"
        sequence="100"
    />
</odoo>
