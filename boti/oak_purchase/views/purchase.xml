<?xml version="1.0" encoding="utf-8" ?>
<odoo>

    <!-- Purchase order base form-->
    <record id="oak_purchase_order_form_inherit" model="ir.ui.view">
        <field name="name">purchase.order.form.inherit</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_form" />
        <field name="arch" type="xml">
            <xpath
                expr="//form/sheet/group/group/field[@name='partner_id']"
                position="before"
            >
               <field name="vendor_ref" readonly="True" />
            </xpath>
            <xpath expr="//button[@name='confirm_reminder_mail']" position="attributes">
               <attribute name="groups" />
            </xpath>
            <xpath expr="//button[@name='action_view_picking']" position="after">
                <button
                    name="action_purchase_confirm_send"
                    string="Send &amp; Confirm"
                    type="object"
                    class="btn-primary"
                    states="done,purchase"
                />
            </xpath>
            <xpath expr="//tree/field[@name='date_planned']" position="before">
                <field name="requested_date" />
            </xpath>
            <xpath expr="//tree/field[@name='date_planned']" position="attributes">
                <attribute name="optional" />
            </xpath>
            <xpath expr="//field[@name='date_order']" position="attributes">
              <attribute
                    name="attrs"
                >{'readonly': [('state','in',('purchase','done'))]}</attribute>
              <attribute name="string">RFQ Deadline</attribute>
            </xpath>
            <xpath expr="//field[@name='date_approve']" position="attributes">
              <attribute name="string">PO Confirmed Date</attribute>
            </xpath>
        </field>
    </record>

    <!-- Purchase order tree view -->
    <record id="oak_purchase_order_view_tree_inherit" model="ir.ui.view">
        <field name="name">purchase.order.view.tree</field>
        <field name="model">purchase.order</field>
        <field name="priority" eval="100" />
        <field name="inherit_id" ref="purchase.purchase_order_view_tree" />
        <field name="arch" type="xml">
            <xpath expr="//tree/field[@name='partner_id']" position="before">
                <field name="vendor_ref" readonly="True" />
            </xpath>
            <!--This is Odoo's recepit status, which we don't like because it's confusing, using an addon instead -->
            <xpath expr="//tree/field[@name='receipt_status']" position="replace">
            </xpath>
        </field>
    </record>

    <!-- Purchase request tree view -->
    <record id="oak_purchase_order_tree_inherit" model="ir.ui.view">
        <field name="name">purchase.order.tree</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_tree" />
        <field name="arch" type="xml">
            <xpath expr="//tree/field[@name='partner_id']" position="before">
                <field name="vendor_ref" readonly="True" />
            </xpath>
        </field>
    </record>

    <!-- RFQ request tree view -->
    <record id="oak_quotation_tree_inherit" model="ir.ui.view">
        <field name="name">purchase.order.tree</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_kpis_tree" />
        <field name="arch" type="xml">
            <xpath expr="//tree/field[@name='partner_id']" position="before">
                <field name="vendor_ref" readonly="True" />
            </xpath>
        </field>
    </record>

    <!-- Purchase order list selection -->
    <record id="oak_view_purchase_order_filter_inherit" model="ir.ui.view">
        <field name="name">request.quotation.select.inherit</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.view_purchase_order_filter" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='partner_id']" position="before">
                <field name="vendor_ref" readonly="True" />
            </xpath>
        </field>
    </record>

    <!-- Purchase order kanban view inherit -->
    <record id="oak_view_purchase_order_kanban_inherit" model="ir.ui.view">
        <field name="name">purchase.view.purchase.order.kanban.inherit</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.view_purchase_order_kanban" />
        <field name="arch" type="xml">
            <xpath
                expr="//strong[hasclass('o_kanban_record_title')]/span/t"
                position="before"
            >
                <a
                    attrs="{'invisible': [('vendor_ref', '=', False)]}"
                    class="oe_read_only"
                >[</a>
                <field name="vendor_ref" class="oe_read_only" />
                <a
                    attrs="{'invisible': [('vendor_ref', '=', False)]}"
                    class="oe_read_only"
                >] </a>
            </xpath>
        </field>
    </record>

    <!-- Purchase order list selection -->
    <record id="oak_purchase_order_view_search_inherit" model="ir.ui.view">
        <field name="name">purchase.order.select.inherit</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_view_search" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='partner_id']" position="before">
                <field name="vendor_ref" />
            </xpath>
        </field>
    </record>

    <!-- Purchase order line tree -->
    <record id="oak_purchase_order_line_tree_inherit" model="ir.ui.view">
        <field name="name">purchase.order.line.inherit</field>
        <field name="model">purchase.order.line</field>
        <field name="inherit_id" ref="purchase.purchase_order_line_tree" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='product_qty']" position="after">
                <field name="qty_received" />
                <field name="mto_origin" optional="hide" />
            </xpath>
            <xpath expr="//field[@name='date_planned']" position="after">
                <field name="requested_date" optional="hide" />
            </xpath>
        </field>
    </record>
</odoo>
